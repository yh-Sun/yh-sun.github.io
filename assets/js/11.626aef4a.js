(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{742:function(s,t,a){"use strict";a.r(t);var e=a(105),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"mysql部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql部署"}},[s._v("#")]),s._v(" mysql部署")]),s._v(" "),a("h3",{attrs:{id:"libaio安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#libaio安装"}},[s._v("#")]),s._v(" libaio安装")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("sudo rpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("prefix"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("libaio libaio"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".107")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.")]),s._v("el6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("force "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("nodeps\nsudo rpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh  libaio"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".107")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.")]),s._v("el6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("force "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("nodeps\n\n# libaio安装\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" rpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh libaio"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".107")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.")]),s._v("el6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm\n")])])]),a("h3",{attrs:{id:"mysql包的安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql包的安装"}},[s._v("#")]),s._v(" MySql包的安装")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("common安装\nrpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("community"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("common"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".26")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm\n# libs安装\nrpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("community"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("libs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".26")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm\n# libs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compat安装\nrpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("community"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("libs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("compat"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".26")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm\n# Client安装\nrpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("community"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".26")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm\n# Server安装\nrpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("community"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".26")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm\n# Devel安装\nrpm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ivh mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("community"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("devel"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".26")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.")]),s._v("el7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rpm  \n")])])]),a("h3",{attrs:{id:"初始化msql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初始化msql"}},[s._v("#")]),s._v(" 初始化msql")]),s._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[s._v("mysqld --initialize\nmysqld --initialize  --lower-case-table-names=1\n\n# 8版本后，不能在配置文件中修改"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("忽略大小写")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("，一个方法就是在初始化时，直接忽略；\nhttps://www.cnblogs.com/niceyoo/p/11545196.html\n    \nvim /etc/my.conf\n    # 忽略略⼤大⼩小写\n    lower——case_table_name=1\n    # sql模式去掉ONLY_FULL_GROUP_BY\n    sql-mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,\n    NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'\n\n详细：\n# 查看是否忽略大小写\nshow Variables like '%table_names'\n\n# 忽略略⼤大⼩小写\nlower——case_table_name=1\n\n# sql模式去掉ONLY_FULL_GROUP_BY\nsql-mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,\nNO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'\n")])])]),a("h3",{attrs:{id:"查看初始化的root用户密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看初始化的root用户密码"}},[s._v("#")]),s._v(" 查看初始化的root用户密码")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("grep 'temporary password' /var/log/mysqld.log\n\n2020-06-23T01:57:33.093785Z 1 [Note] A temporary password is generated for root@localhost: ChBya?ymX9*/\n")])])]),a("h3",{attrs:{id:"修改-var-lib-mysql的权限一边启动mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改-var-lib-mysql的权限一边启动mysql"}},[s._v("#")]),s._v(" 修改/var/lib/mysql的权限一边启动mysql")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chown mysql:mysql -R /var/lib/mysql\n")])])]),a("h3",{attrs:{id:"启动mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动mysql"}},[s._v("#")]),s._v(" 启动mysql")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("systemctl start mysqld\n\n查看mysql启动状态\nsystemctl status mysqld\n\n设置开机自启\nsystemctl enable mysqld\n\n重启mysql \nservice mysqld restart\n")])])]),a("h3",{attrs:{id:"修改密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改密码"}},[s._v("#")]),s._v(" 修改密码")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1.开始使用此种方式，没有生效，所以采用其他方法：\nmysqladmin -u root -p password [新密码]\n\t->会提示输⼊入旧密码，输⼊入4.4打印出的密码\n\t\n2.思路：\n# 修改my.conf，root跳过密码校验登录；\n\n# 登录成功后，修改user表root用户的密码；\nupdate user set authentication_string=password('root') where user='root' and host='localhost';\n\n# 重新修改my.conf，重新加入密码验证；\n")])])]),a("h3",{attrs:{id:"授权bbw-b2b用户拥有对数据库的操作权限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#授权bbw-b2b用户拥有对数据库的操作权限"}},[s._v("#")]),s._v(" 授权bbw_b2b用户拥有对数据库的操作权限")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("生产环境\ngrant all privileges on kscd_dev.* to kscd_dev@'%'  identified by 'Kscd_dev@123'; \ngrant all privileges on kscd_prod.* to kscd_prod@'%'  identified by 'Kscd_prod@123'; \n\n刷新系统权限\nflush privileges;\n")])])]),a("h3",{attrs:{id:"创建用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建用户"}},[s._v("#")]),s._v(" 创建用户")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("查看多少数据库\nshow databases;\n\n创建用户：\nCREATE USER 'kscd_dev'@'%' IDENTIFIED BY 'Kscd_dev@123';\nCREATE USER 'kscd_prod'@'%' IDENTIFIED BY 'Kscd_prod@123';\n\n创建数据库：\ncreate database kscd_dev;\n\nmysql创建数据库并设置字符集编码\ncreate database `kscd_prod` character set utf8mb4 collate utf8mb4_general_ci;\n")])])]),a("h3",{attrs:{id:"账号密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#账号密码"}},[s._v("#")]),s._v(" 账号密码")]),s._v(" "),a("blockquote",[a("p",[s._v("root账号密码：root root")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("kscd_dev\nKscd_dev@123\nCREATE USER 'kscd_dev'@'%' IDENTIFIED BY 'Kscd_dev@123';\n\nkscd_dev\ncreate database kscd_dev;\n")])])]),a("h3",{attrs:{id:"卸载mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#卸载mysql"}},[s._v("#")]),s._v(" 卸载MySql")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("https://www.cnblogs.com/nicknailo/articles/8563456.html\nrpm -qa|grep -i mysql\n\nrpm -ev mysql-community-common-5.7.26-1.el7.x86_64 --nodeps\nrpm -ev mysql-community-libs-compat-5.7.26-1.el7.x86_64 --nodeps\nrpm -ev mysql-community-server-5.7.26-1.el7.x86_64 --nodeps\nrpm -ev mysql-community-libs-5.7.26-1.el7.x86_64 --nodeps\nrpm -ev mysql-community-client-5.7.26-1.el7.x86_64 --nodeps\nrpm -ev mysql-community-devel-5.7.26-1.el7.x86_64 --nodeps\n")])])]),a("h2",{attrs:{id:"mysql非root用户离线安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql非root用户离线安装"}},[s._v("#")]),s._v(" Mysql非root用户离线安装")]),s._v(" "),a("blockquote",[a("p",[s._v("Linux非root用户安装及配置MySql，摘抄至：https://cloud.tencent.com/developer/article/1583129")])]),s._v(" "),a("ul",[a("li",[s._v("一、下载安装包")]),s._v(" "),a("li",[s._v("二、解压及编写配置文件\n"),a("ul",[a("li",[s._v("1、解压文件")]),s._v(" "),a("li",[s._v("2、编写配置文件")])])]),s._v(" "),a("li",[s._v("三、安装MySql")]),s._v(" "),a("li",[s._v("四、启动MySql")]),s._v(" "),a("li",[s._v("五、登录MySql\n"),a("ul",[a("li",[s._v("1、获取root用户密码")]),s._v(" "),a("li",[s._v("2、登录MySql 查看报错")]),s._v(" "),a("li",[s._v("3、增加sock路径进行启动")]),s._v(" "),a("li",[s._v("4、修改初始密码")]),s._v(" "),a("li",[s._v("5、查看MySql进程状态")])])]),s._v(" "),a("li",[s._v("六、参考文献")]),s._v(" "),a("li",[s._v("七、离线安装包")])]),s._v(" "),a("h3",{attrs:{id:"下载安装包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载安装包"}},[s._v("#")]),s._v(" 下载安装包")]),s._v(" "),a("p",[s._v("镜像站网址（极力推荐，下载速度贼快）："),a("code",[s._v("http://mirrors.ustc.edu.cn/")])]),s._v(" "),a("p",[s._v("我用的经镜像站："),a("code",[s._v("http://mirrors.ustc.edu.cn/mysql-ftp/Downloads/MySQL-5.7/")]),s._v(" 选用版本为："),a("code",[s._v("mysql-5.7.29-linux-glibc2.12-x86_64.tar.gz")]),s._v("（文章时间是最新的版本）")]),s._v(" "),a("p",[s._v("安装包下载过程非常简单。上传到服务器内也是非常简单，这里就不细写了！")]),s._v(" "),a("h3",{attrs:{id:"解压及编写配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解压及编写配置文件"}},[s._v("#")]),s._v(" 解压及编写配置文件")]),s._v(" "),a("h4",{attrs:{id:"解压文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解压文件"}},[s._v("#")]),s._v(" 解压文件")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("tar "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("zxvf mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".29")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("glibc2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz\nmv mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v(".29")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("linux"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("glibc2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("x86_64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gz mysql\ncd mysql\n")])])]),a("p",[s._v("以上三条命令，按照顺序依次执行即可。（后面的文件名，根据实时的下载，自行替换）")]),s._v(" "),a("h4",{attrs:{id:"编写配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写配置文件"}},[s._v("#")]),s._v(" 编写配置文件")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("vim my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf\n")])])]),a("p",[s._v("将如下代码直接复制进去。 说明：oper为 用户名称  mysql 是上一步我们mv重命名的文件名")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("   \nport"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3336")]),s._v("  \nsocket"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock  \n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nport"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3336")]),s._v("\nbasedir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql\ndatadir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data\npid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pid\nsocket"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock\nlog_error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log\nserver"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n")])])]),a("h3",{attrs:{id:"安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[s._v("#")]),s._v(" 安装MySql")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysqld \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("defaults"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kscd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("initialize \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kscd \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("basedir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kscd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql \\\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("datadir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kscd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data\n")])])]),a("p",[s._v("以上命令，挨行依次复制，然后按回车，输入完最后一行回车。如果成功无任何返回结果，如出现任何返回结果即为失败。")]),s._v(" "),a("h3",{attrs:{id:"启动mysql-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动mysql-2"}},[s._v("#")]),s._v(" 启动MySql")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysqld_safe "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("defaults"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kscd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n\nbin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysqld_safe "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("defaults"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("etc")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-flags"}},[s._v("my")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])])]),a("p",[s._v("这里是可以成功执行的。继续下一步。")]),s._v(" "),a("h3",{attrs:{id:"登录mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录mysql"}},[s._v("#")]),s._v(" 登录MySql")]),s._v(" "),a("h4",{attrs:{id:"获取root用户密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取root用户密码"}},[s._v("#")]),s._v(" 获取root用户密码")]),s._v(" "),a("p",[s._v("初始密码在error.log文件中，输入如下命令：")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("cat error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" grep root@localhost\n")])])]),a("h4",{attrs:{id:"登录mysql-查看报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录mysql-查看报错"}},[s._v("#")]),s._v(" 登录MySql 查看报错")]),s._v(" "),a("p",[s._v("这里因为是非oper用户，所以正常登录命令应该是："),a("code",[s._v("bin/mysql -u root -p")]),s._v("，但是即使你这样输入了，一样报错。会给你报如下错误代码。")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ERROR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2002")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("HY000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" Can"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t connect to local MySQL server through socket '")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("tmp"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock' "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("h4",{attrs:{id:"增加sock路径进行启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#增加sock路径进行启动"}},[s._v("#")]),s._v(" 增加sock路径进行启动")]),s._v(" "),a("p",[s._v("所以直接加sock的启动命令：(有点笨重，但是能实现)（更好的办法我也没找到）")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("S")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kscd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock\n")])])]),a("h4",{attrs:{id:"修改初始密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改初始密码"}},[s._v("#")]),s._v(" 修改初始密码")]),s._v(" "),a("p",[s._v("登录成功之后，进行初始密码的修改")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SET")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PASSWORD")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'oper'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("mysql -uroot -p\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SET PASSWORD FOR "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" PASSWORD"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" update user "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("host")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" where user "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  flush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h4",{attrs:{id:"查看mysql进程状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看mysql进程状态"}},[s._v("#")]),s._v(" 查看MySql进程状态")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("ps "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("ef"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("grep mysql\n")])])]),a("p",[s._v("输入如上命令，即可查看到MySql的进程状态。")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("oper       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8133")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7553")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" pts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sh bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysqld_safe "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("defaults"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("opermysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("oper\noper       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8298")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8133")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" pts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysqld "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("defaults"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cnf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("basedir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("datadir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("data "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("plugin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("lib"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("plugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("pid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pid "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("socket"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("oper"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sock "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3336")]),s._v("\noper       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9138")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8343")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(" pts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("00")]),s._v(" grep "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("color"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("auto mysql\n")])])]),a("h3",{attrs:{id:"自己的想法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自己的想法"}},[s._v("#")]),s._v(" 自己的想法")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sun@localhost mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ bin/mysqld --defaults-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/sun/mysql/my.cnf --initialize --user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sun --basedir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/sun/mysql --datadir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/sun/mysql/data\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sun@localhost mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ bin/mysqld_safe --defaults-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/sun/mysql/my.cnf --user"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sun "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])])]),a("h4",{attrs:{id:"环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[s._v("#")]),s._v(" 环境变量")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" ~/.bash_profile\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/sun/mysql\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.local/bin:"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/bin:"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$MYSQL_HOME")]),s._v("/bin\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" ~/.bash_profile\n")])])]),a("h4",{attrs:{id:"创建软引用解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建软引用解决"}},[s._v("#")]),s._v(" 创建软引用解决：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建前：报错，必须制定 对应的sock地址：mysql -uroot -p -S /home/sun/mysql/mysql.sock")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sun@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ mysql -uroot -p\nEnter password: \nERROR "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2002")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HY000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": Can"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'t connect to local MySQL server through socket '")]),s._v("/tmp/mysql.sock' "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建软引用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sun@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /home/sun/mysql/mysql.sock /tmp\n\t\t\t\t\t\t\t\t  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /home/kscd/mysql/mysql.sock /tmp\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可直接登录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sun@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ mysql -uroot -p\nEnter password: \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mysql:\n")])])]),a("h4",{attrs:{id:"数据库创建用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库创建用户"}},[s._v("#")]),s._v(" 数据库创建用户：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("创建数据库：\ncreate database ts_kscd_dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\ncreate database nacos_prod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n创建用户\nCREATE "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kscd_dev'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED BY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Kscd_dev@123'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n为用户赋予ts_kscd_dev权限\ngrant all privileges on ts_kscd_dev.* to kscd_dev@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v("  identified by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Kscd_dev@123'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \ngrant all privileges on nacos_prod.* to kscd_prod@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v("  identified by "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Kscd_prod@123'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n\n刷新系统权限\nflush privileges"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h2",{attrs:{id:"保司2保险快速出单-mysql数据库主从配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#保司2保险快速出单-mysql数据库主从配置"}},[s._v("#")]),s._v(" 保司2保险快速出单-mysql数据库主从配置")]),s._v(" "),a("h3",{attrs:{id:"主从环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主从环境准备"}},[s._v("#")]),s._v(" 主从环境准备：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("名称")]),s._v(" "),a("th",[s._v("IP")]),s._v(" "),a("th",[s._v("服务器账号")]),s._v(" "),a("th",[s._v("数据库账号")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("msyql-master（主库）")]),s._v(" "),a("td",[s._v("10.10.10.1")]),s._v(" "),a("td",[s._v("root/root")]),s._v(" "),a("td",[s._v("root/@mima18"),a("br"),s._v("kscd/mima2018@")])]),s._v(" "),a("tr",[a("td",[s._v("mysql-slave（从库）")]),s._v(" "),a("td",[s._v("10.10.10.2")]),s._v(" "),a("td",[s._v("root/root")]),s._v(" "),a("td",[s._v("root/@mima18")])])])]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("kscd：应用层使用的数据库账号")])])]),s._v(" "),a("h3",{attrs:{id:"配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置：")]),s._v(" "),a("p",[a("strong",[s._v("（1）配置主库")])]),s._v(" "),a("ul",[a("li",[s._v("修改my.cnf文件：")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ecs-afea ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/my.cnf")]),s._v("\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务的唯一编号")]),s._v("\n server-id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启mysql binlog功能")]),s._v("\n log-bin"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql-bin\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# binlog记录内容的方式，记录被操作的每一行")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_format")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ROW\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 减少记录日志的内容，只记录受影响的列")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_row_image")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("minimal\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定需要复制的数据库名为ts_kscd_dev，如果复制多个数据库，则另起一行再配置一个binlog-do-db")]),s._v("\n binlog-do-db"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ts_kscd_dev\n \n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# slave_skip_errors选项有四个可用值，分别为：off，all，ErorCode，ddl_exist_errors；")]),s._v("\n "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保司1线上配置的是ddl_exist_errors，此次我们配置all，更多见【附录1】")]),s._v("\n slave_skip_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" all\n")])])]),a("ul",[a("li",[s._v("修改好配置文件，重启mysql服务")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以下两种方式：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".service mysqld restart\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".systemctl restart mysqld\n")])])]),a("p",[s._v("**注意：**下面命令是在mysql的终端执行的。")]),s._v(" "),a("ul",[a("li",[s._v("创建从库同步数据的账号")])]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 在主服务器给某一用户赋予slave权限，可以是java应用采用的用户；并替换成从服务器的IP即可。\nmysql> grant replication slave on *.* to 'kscd'@'10.1.10.100' identified by 'mima2018@';\n\ngrant replication slave on *.* to 'kscd_prod'@'10.1.10.101' identified by 'Kscd_prod@123';\n")])])]),a("blockquote",[a("p",[s._v("查看主库的状态，如下所示主库配置完成")])]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> show master status\\G\n*************************** 1. row ***************************\n             File: mysql-bin.000003\n         Position: 138430\n     Binlog_Do_DB: ts_kscd_dev\n Binlog_Ignore_DB: \nExecuted_Gtid_Set: \n1 row in set (0.00 sec)\n")])])]),a("p",[a("strong",[s._v("（2）配置从库")])]),s._v(" "),a("ul",[a("li",[s._v("修改my.cnf文件：")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 服务的唯一编号，主从编号不能相同")]),s._v("\nserver-id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 剩余配置同【主】")]),s._v("\n")])])]),a("ul",[a("li",[s._v("修改好配置文件，重启mysql服务")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以下两种方式：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".service mysqld restart\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".systemctl restart mysqld\n")])])]),a("p",[s._v("**注意：**下面命令是在mysql的终端执行的。")]),s._v(" "),a("ul",[a("li",[s._v("执行同步命令：")])]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 设置主服务器ip，同步账号密码，同步位置\nmysql> change master to master_host='10.1.1.200',master_user='kscd',master_password='mima2018@',master_log_file='mysql-bin.000004',master_log_pos=27318;\n\nchange master to master_host='10.1.1.201',master_user='kscd_dev',master_password='Kscd_dev@123',master_log_file='mysql-bin.000003',master_log_pos=900474829;\n\nchange master to master_host='10.1.1.202',master_user='kscd',master_password='mima2018@',master_log_file='mysql-bin.000003',master_log_pos=900474829;\n\n# 开启同步功能\nmysql> start slave;\n\n# 关闭\nmysql> stop slave;\n")])])]),a("blockquote",[a("p",[s._v("查看从库的状态")])]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> show slave status\\G\n*************************** 1. row ***************************\n               Slave_IO_State: Waiting for master to send event\n                  Master_Host: 10.10.10.1\n                  Master_User: kscd\n                  Master_Port: 3306\n                Connect_Retry: 60\n              Master_Log_File: mysql-bin.000003\n          Read_Master_Log_Pos: 138430\n               Relay_Log_File: VM_0_16_centos-relay-bin.000009\n                Relay_Log_Pos: 138643\n        Relay_Master_Log_File: mysql-bin.000003\n             Slave_IO_Running: Yes\n            Slave_SQL_Running: Yes\n              Replicate_Do_DB: \n          Replicate_Ignore_DB: \n           Replicate_Do_Table: \n       Replicate_Ignore_Table: \n      Replicate_Wild_Do_Table: \n  Replicate_Wild_Ignore_Table: \n                   Last_Errno: 0\n                   Last_Error: \n                 Skip_Counter: 0\n          Exec_Master_Log_Pos: 138430\n              Relay_Log_Space: 139025\n              Until_Condition: None\n               Until_Log_File: \n                Until_Log_Pos: 0\n           Master_SSL_Allowed: No\n           Master_SSL_CA_File: \n           Master_SSL_CA_Path: \n              Master_SSL_Cert: \n            Master_SSL_Cipher: \n               Master_SSL_Key: \n        Seconds_Behind_Master: 0\nMaster_SSL_Verify_Server_Cert: No\n                Last_IO_Errno: 0\n                Last_IO_Error: \n               Last_SQL_Errno: 0\n               Last_SQL_Error: \n  Replicate_Ignore_Server_Ids: \n             Master_Server_Id: 1\n                  Master_UUID: 58ee127b-bb73-11ea-ba28-fa163e70bf10\n             Master_Info_File: /var/lib/mysql/master.info\n                    SQL_Delay: 0\n          SQL_Remaining_Delay: NULL\n      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates\n           Master_Retry_Count: 86400\n                  Master_Bind: \n      Last_IO_Error_Timestamp: \n     Last_SQL_Error_Timestamp: \n               Master_SSL_Crl: \n           Master_SSL_Crlpath: \n           Retrieved_Gtid_Set: \n            Executed_Gtid_Set: fa2b2c8a-e4b4-11e8-9827-525400caee62:1-5124366\n                Auto_Position: 0\n         Replicate_Rewrite_DB: \n                 Channel_Name: \n           Master_TLS_Version: \n1 row in set (0.00 sec)\n\n")])])]),a("p",[a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729031800.png",alt:"enter description here"}})]),s._v(" "),a("p",[s._v("**注意：**Slave_IO_Running和Slave_SQL_Running的状态都为Yes时，说明从库配置成功。")]),s._v(" "),a("h3",{attrs:{id:"使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用：")]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 使用kscd账号登录mysql\nmysql -ukscd -p******\n\n# 切换到配置主动的库\nmysql> use ts_kscd_dev;\n\nmysql> #尽情的增删改吧。\n")])])]),a("h3",{attrs:{id:"附录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附录"}},[s._v("#")]),s._v(" 附录：")]),s._v(" "),a("h4",{attrs:{id:"slave-skip-errors"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#slave-skip-errors"}},[s._v("#")]),s._v(" slave_skip_errors")]),s._v(" "),a("ul",[a("li",[s._v("ddl_exist_errors是MySql5.6增加的参数，更适合实际的应用")]),s._v(" "),a("li",[s._v("如下的这些码值，在从库终端中执行以下命令：show slave status\\G;\n"),a("ul",[a("li",[s._v("Last_Errno: 1062")]),s._v(" "),a("li",[s._v("Last_Error: Error 'Duplicate entry '3' for key '"),a("strong",[s._v("PRIMARY")]),s._v("'' "),a("strong",[s._v("on")]),s._v(" query. "),a("strong",[s._v("Default")]),s._v(" "),a("strong",[s._v("database")]),s._v(": 'test'. Query: 'insert into replication values (3, 'test3')'")]),s._v(" "),a("li",[s._v("如果我们在my.cnf中加入[slave_skip_errors=1062 ]，则可跳过此错误，数据同步继续进行。")])])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729147519.png",alt:"enter description here"}})]),s._v(" "),a("ul",[a("li",[s._v("必须注意的是，启动这个参数，如果处理不当，很可能造成主从数据库的数据不同步，在应用中需要根据实际情况，如果对数据完整性要求不是很严格，那么这个选项确实可以减轻维护的成本")])]),s._v(" "),a("h4",{attrs:{id:"初次设置主从的数据同步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#初次设置主从的数据同步"}},[s._v("#")]),s._v(" 初次设置主从的数据同步")]),s._v(" "),a("blockquote",[a("p",[s._v("初次使用：主库=>从库")])]),s._v(" "),a("div",{staticClass:"language-mysql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 1.主服务器：执行以下命令锁定数据库以防止写入数据\nmysql> FLUSH TABLES WITH READ LOCK;\n\n# 退出mysql命令行，导出数据库\nmysqldump -u root -p123456 --all-databases  --lock-tables=false  -- > /root/all.sql\n# 导出某些库\nmysqldump -uusername -ppassword --databases db1 db2 > db1db2.sql\n# 导出某些库的表\nmysqldump -uroot -p  ts_kscd_uat order_vehicle > /home/kscd/uat_order_vehicle.sql\n\n# 使用scp命令传输数据库文件all.sql到从服务器\nscp /root/all.sql root@www.example.com:/root\n\n# 解锁数据表\nmysql> UNLOCK TABLES;\n\n\n# 2.从服务器：导入主服务器的数据库,vi一下这个sql，use ts_kscd_dev\nmysql -u root -p123456 < /root/all.sql\n")])])]),a("h5",{attrs:{id:"同步数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#同步数据"}},[s._v("#")]),s._v(" 同步数据：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("同步数据：\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ecs-c6-xlarge-4-linux-20200825085913 home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysqldump -uroot -p --databases ts_kscd_dev > /home/ts_kscd_dev.sql    ")]),s._v("\nEnter password: \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ecs-c6-xlarge-4-linux-20200825085913 home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("288280")]),s._v("\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":54 app_store\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" root root      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":58 mysql\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("295186794")]),s._v(" Sep "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":05 ts_kscd_dev.sql\n")])])]),a("h4",{attrs:{id:"expire-logs-days"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#expire-logs-days"}},[s._v("#")]),s._v(" expire_logs_days")]),s._v(" "),a("div",{staticClass:"language-c++ extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("MySQL bin-log相关参数：expire_logs_days\n参数：expire_logs_days\n说明：二进制日志自动删除/过期的天数。默认值为0,表示“没有自动删除”\n例如：expire_logs_days = 5 //表示日志保留5天,超过5天则设置为过期的\n\nPS：关于过期日志自动删除补充：\nQ：在什么时间会删除过期日志？\nA：每次进行 LOG flush的时会自动删除过期的日志。\n\nQ：什么时间才能触发log flush，手册上的解释为：\nA：1. 重启；\n　   2. BINLOG文件大小达到参数max_binlog_size限制；\n　   3. 手工执行命令。\n")])])]),a("h4",{attrs:{id:"binlog-rows-query-log-events"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#binlog-rows-query-log-events"}},[s._v("#")]),s._v(" binlog_rows_query_log_events")]),s._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[s._v("binlog_rows_query_log_events = 1\n在row模式下开启该参数,将把sql语句打印到binlog日志里面.默认是0(off);\n\n详：https://www.cnblogs.com/olinux/p/6755193.html\n")])])]),a("p",[a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729184127.png",alt:"enter description here"}})]),s._v(" "),a("h4",{attrs:{id:"log-slave-updates"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#log-slave-updates"}},[s._v("#")]),s._v(" log-slave-updates")]),s._v(" "),a("blockquote",[a("p",[s._v("这个参数，目前没有配置，还未研究透。")]),s._v(" "),a("p",[s._v("帖子结论：从库做为其他从库的主库时需要在配置文件中添加log-slave-updates参数")]),s._v(" "),a("p",[s._v("有兴趣的请见：https://www.cnblogs.com/lit10050528/p/4156755.html")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729197455.png",alt:"enter description here"}})]),s._v(" "),a("h4",{attrs:{id:"保司2快出的主从配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#保司2快出的主从配置"}},[s._v("#")]),s._v(" 保司2快出的主从配置")]),s._v(" "),a("p",[s._v("my.cnf")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[client]\nport=3306\n\ndefault-character-set=utf8mb4\n\nsocket=/home/mysql/mysql.sock\n\n[mysqld]\nport=3306\n\n# character\ncharacter-set-server=utf8mb4\ncollation-server=utf8mb4_general_ci\n\n# work dir\nbasedir=/home/mysql\ndatadir=/home/mysql/data\npid-file=/home/mysql/mysql.pid\nsocket=/home/mysql/mysql.sock\nlog_error=/home/mysql/error.log\n\n# common config\nlower_case_table_names=1\n# sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'\n\n\n# mysql read write config\nserver-id=2\nlog-bin=mysql-bin\nbinlog_format=ROW\nbinlog_row_image=minimal\n\nbinlog-do-db=ts_kscd_dev\nbinlog-do-db=shard_test0\nbinlog-do-db=shard_test1\n\nslave_skip_errors = all\n\n")])])]),a("p",[s._v("安装")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("bin/mysqld \\\n--defaults-file=/home/kscd/mysql/my.cnf \\\n--initialize \\\n--user=kscd \\\n--basedir=/home/kscd/mysql \\\n--datadir=/home/kscd/mysql/data\n")])])]),a("p",[s._v("启动")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("bin/mysqld_safe \\\n--defaults-file=/home/kscd/mysql/my.cnf \\\n--user=kscd &\n\n")])])]),a("h4",{attrs:{id:"保司1快出主从配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#保司1快出主从配置"}},[s._v("#")]),s._v(" 保司1快出主从配置")]),s._v(" "),a("blockquote",[a("p",[s._v("供保司1参考：由于小作者没有copy的习惯，很多参数都需要研究后再加上。希望后续小伙伴可以将剩余的参数定义到附录中；")]),s._v(" "),a("p",[s._v("如果写的不对，还请大家批评指正呀呀呀~么么哒")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("my-master.cnf")])])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nprompt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("u@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("_\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql#123"')]),s._v("\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306/mysql.sock\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# basic settings #")]),s._v("\nserver-id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\nbind_address "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql\nsql_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER"')]),s._v("\nautocommit "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("character_set_server")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4\ntransaction_isolation "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" READ-COMMITTED\nexplicit_defaults_for_timestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nmax_allowed_packet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16777216")]),s._v("\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  /data/db/mysql/3306\ninnodb_log_group_home_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306\ninnodb_undo_directory "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306 \nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306/mysql.sock\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("query_cache_type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("query_cache_size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \nevent_scheduler "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_bin_trust_function_creators "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlower_case_table_names "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nrelay_log_purge "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nread_only "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# connection #")]),s._v("\ninteractive_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800")]),s._v("\nwait_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800")]),s._v("\nlock_wait_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800")]),s._v("\nskip_name_resolve "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nmax_connections "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("\nmax_connect_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# table cache performance settings")]),s._v("\ntable_open_cache "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\ntable_definition_cache "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\ntable_open_cache_instances "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# session memory settings #")]),s._v("\nread_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 16M\nread_rnd_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 32M\nsort_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 32M\ntmp_table_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 64M\njoin_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 128M\nthread_cache_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log settings #")]),s._v("\nlog_error "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" error.log\nslow_query_log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nslow_query_log_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" slow.log\nlog_queries_not_using_indexes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_slow_admin_statements "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_slow_slave_statements "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_throttle_queries_not_using_indexes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nexpire_logs_days "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nlong_query_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nmin_examined_row_limit "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nbinlog-rows-query-log-events "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog-bin-trust-function-creators "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog-slave-updates "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# innodb settings #")]),s._v("\ninnodb_page_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16384")]),s._v("\ninnodb_buffer_pool_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 20G\ninnodb_buffer_pool_instances "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ninnodb_buffer_pool_load_at_startup "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_buffer_pool_dump_at_shutdown "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_lru_scan_depth "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\ninnodb_lock_wait_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\ninnodb_io_capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4000")]),s._v("\ninnodb_io_capacity_max "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\ninnodb_flush_method "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" O_DIRECT\ninnodb_file_format "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Barracuda\ninnodb_file_format_max "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Barracuda\ninnodb_undo_logs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\ninnodb_undo_tablespaces "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\ninnodb_flush_neighbors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ninnodb_log_file_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1024M\ninnodb_log_files_in_group "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\ninnodb_log_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16777216")]),s._v("\ninnodb_purge_threads "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\ninnodb_large_prefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_thread_concurrency "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\ninnodb_print_all_deadlocks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_strict_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_sort_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("67108864")]),s._v("\ninnodb_write_io_threads "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ninnodb_read_io_threads "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" \ninnodb_file_per_table "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_stats_persistent_sample_pages "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\ninnodb_autoinc_lock_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_online_alter_log_max_size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1G\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_open_files")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# replication settings #")]),s._v("\nmaster_info_repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TABLE\nrelay_log_info_repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TABLE\nlog_bin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" binlog\nsync_binlog "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ngtid_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\nenforce_gtid_consistency "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_slave_updates\nbinlog_format "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ROW\nbinlog_rows_query_log_events "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrelay_log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" relay.log\nrelay_log_recovery "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nslave_skip_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ddl_exist_errors\nslave-rows-search-algorithms "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'INDEX_SCAN,HASH_SCAN'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# semi sync replication settings #")]),s._v("\nplugin_load "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"validate_password.so;rpl_semi_sync_master=semisync_master.so;rpl_semi_sync_slave=semisync_slave.so"')]),s._v("\nrpl_semi_sync_master_enabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrpl_semi_sync_master_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\nrpl_semi_sync_slave_enabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# password plugin #")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("validate_password_policy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STRONG\nvalidate-password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("FORCE_PLUS_PERMANENT\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld-5.6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# metalock performance settings")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("metadata_locks_hash_instances")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld-5.7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# new innodb settings #")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("loose_innodb_numa_interleave")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_buffer_pool_dump_pct "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("\ninnodb_page_cleaners "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ninnodb_undo_log_truncate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_max_undo_log_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2G\ninnodb_purge_rseg_truncate_frequency "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# new replication settings #")]),s._v("\nslave-parallel-type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" LOGICAL_CLOCK\nslave-parallel-workers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("slave_preserve_commit_order")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("slave_transaction_retries")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# other change settings #")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_gtid_simple_recovery")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("log_timestamps")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("system\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("show_compatibility_56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("on\n")])])]),a("ul",[a("li",[a("strong",[s._v("my-slave.cnf")])])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nprompt "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("u@"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("_\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql#123"')]),s._v("\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306/mysql.sock\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# basic settings #")]),s._v("\nserver-id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\nbind_address "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql\nsql_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER"')]),s._v("\nautocommit "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("character_set_server")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8mb4\ntransaction_isolation "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" READ-COMMITTED\nexplicit_defaults_for_timestamp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nmax_allowed_packet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16777216")]),s._v("\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  /data/db/mysql/3306\ninnodb_log_group_home_dir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306\ninnodb_undo_directory "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306 \nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /data/db/mysql/3306/mysql.sock\n\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("query_cache_type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("query_cache_size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \nevent_scheduler "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_bin_trust_function_creators "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlower_case_table_names "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nrelay_log_purge "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# connection #")]),s._v("\ninteractive_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800")]),s._v("\nwait_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800")]),s._v("\nlock_wait_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800")]),s._v("\nskip_name_resolve "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nmax_connections "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v("\nmax_connect_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# table cache performance settings")]),s._v("\ntable_open_cache "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\ntable_definition_cache "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\ntable_open_cache_instances "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# session memory settings #")]),s._v("\nread_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 16M\nread_rnd_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 32M\nsort_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1G\ntmp_table_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1G\njoin_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 128M\nthread_cache_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# log settings #")]),s._v("\nlog_error "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" error.log\nslow_query_log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nslow_query_log_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" slow.log\nlog_queries_not_using_indexes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_slow_admin_statements "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_slow_slave_statements "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_throttle_queries_not_using_indexes "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nexpire_logs_days "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nlong_query_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nmin_examined_row_limit "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nbinlog-rows-query-log-events "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog-bin-trust-function-creators "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog-slave-updates "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# innodb settings #")]),s._v("\ninnodb_page_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16384")]),s._v("\ninnodb_buffer_pool_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 16G\ninnodb_buffer_pool_instances "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ninnodb_buffer_pool_load_at_startup "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_buffer_pool_dump_at_shutdown "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_lru_scan_depth "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("\ninnodb_lock_wait_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\ninnodb_io_capacity "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4000")]),s._v("\ninnodb_io_capacity_max "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\ninnodb_flush_method "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" O_DIRECT\ninnodb_file_format "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Barracuda\ninnodb_file_format_max "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Barracuda\ninnodb_undo_logs "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\ninnodb_undo_tablespaces "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\ninnodb_flush_neighbors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ninnodb_log_file_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 1024M\ninnodb_log_files_in_group "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\ninnodb_log_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16777216")]),s._v("\ninnodb_purge_threads "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\ninnodb_large_prefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_thread_concurrency "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\ninnodb_print_all_deadlocks "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_strict_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_sort_buffer_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("67108864")]),s._v("\ninnodb_write_io_threads "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ninnodb_read_io_threads "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" \ninnodb_file_per_table "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_stats_persistent_sample_pages "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\ninnodb_autoinc_lock_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_online_alter_log_max_size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1G\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("innodb_open_files")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# replication settings #")]),s._v("\nmaster_info_repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TABLE\nrelay_log_info_repository "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" TABLE\nlog_bin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" binlog\nsync_binlog "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ngtid_mode "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\nenforce_gtid_consistency "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nlog_slave_updates\nbinlog_format "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ROW\nbinlog_rows_query_log_events "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrelay_log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" relay.log\nrelay_log_recovery "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nslave_skip_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ddl_exist_errors\nslave-rows-search-algorithms "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'INDEX_SCAN,HASH_SCAN'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# semi sync replication settings #")]),s._v("\nplugin_load "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"validate_password.so;rpl_semi_sync_master=semisync_master.so;rpl_semi_sync_slave=semisync_slave.so"')]),s._v("\nrpl_semi_sync_master_enabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nrpl_semi_sync_master_timeout "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\nrpl_semi_sync_slave_enabled "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\nread_only "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# password plugin #")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("validate_password_policy")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STRONG\nvalidate-password"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("FORCE_PLUS_PERMANENT\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld-5.6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# metalock performance settings")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("metadata_locks_hash_instances")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld-5.7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# new innodb settings #")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("loose_innodb_numa_interleave")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_buffer_pool_dump_pct "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v("\ninnodb_page_cleaners "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\ninnodb_undo_log_truncate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ninnodb_max_undo_log_size "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 2G\ninnodb_purge_rseg_truncate_frequency "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# new replication settings #")]),s._v("\nslave-parallel-type "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" LOGICAL_CLOCK\nslave-parallel-workers "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("slave_preserve_commit_order")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("slave_transaction_retries")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# other change settings #")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("binlog_gtid_simple_recovery")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("log_timestamps")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("system\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("show_compatibility_56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("on\n")])])]),a("h4",{attrs:{id:"mysql主从复制-启动slave时-出现下面报错-slave-failed-to-initialize-relay-log-info-structure-from-the-repository"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mysql主从复制-启动slave时-出现下面报错-slave-failed-to-initialize-relay-log-info-structure-from-the-repository"}},[s._v("#")]),s._v(" MySQL主从复制，启动slave时，出现下面报错：Slave failed to initialize relay log info structure from the repository")]),s._v(" "),a("div",{staticClass:"language-crmsh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("MySQL主从复制，启动slave时，出现下面报错：\nmysql> start slave;\nERROR 1872 (HY000): Slave failed to initialize relay log info structure from the repository\n\n解决办法：查看日志，\n这里写图片描述\n可以看到报错，原来是找不到./server246-relay-bin.index文件，找到原因所在了，由于我使用的是冷备份文件恢复的实例，在mysql库中的slave_relay_log_info表中依然保留之前relay_log的信息，所以导致启动slave报错。\nmysql提供了工具用来删除记录：slave reset；\nslave reset执行候做了这样几件事：\n1、删除slave_master_info ，slave_relay_log_info两个表中数据；\n2、删除所有relay log文件，并重新创建新的relay log文件；\n3、不会改变gtid_executed 或者 gtid_purged的值\n\nmysql> reset slave;\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> change master to ......\n\nmysql> start slave;\nQuery OK, 0 rows affected (0.00 sec)\n1\n2\n3\n4\n5\n6\n7\n8\n这样slave 就可以启动了。\n")])])]),a("h2",{attrs:{id:"shardingsphere-proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shardingsphere-proxy"}},[s._v("#")]),s._v(" shardingsphere-proxy")]),s._v(" "),a("h3",{attrs:{id:"下载sharding-proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载sharding-proxy"}},[s._v("#")]),s._v(" 下载sharding-proxy")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本次部署在：10.10.10.1的/home/shardingsphere，与主库在一台机器")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 镜像站网址，下载的快")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://mirrors.tuna.tsinghua.edu.cn/apache/shardingsphere/4.1.0/apache-shardingsphere-4.1.0-sharding-proxy-bin.tar.gz\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -xf apache-shardingsphere-4.1.0-sharding-proxy-bin.tar.gz\n")])])]),a("ul",[a("li",[a("strong",[s._v("vim server.yaml")])])]),s._v(" "),a("blockquote",[a("p",[s._v("shardingsphere-proxy的服务配置")])]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 认证信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("authentication")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("users")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("root")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sharding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sharding\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("authorizedSchemas")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sharding_db\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 公用属性")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("max.connections.size.per.query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("acceptor.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The default value is available processors count * 2.")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("executor.size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Infinite by default.")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("proxy.frontend.flush.threshold")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The default value is 128.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# LOCAL: Proxy will run with LOCAL transaction.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# XA: Proxy will run with XA transaction.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# BASE: Proxy will run with B.A.S.E transaction.")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("proxy.transaction.type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" LOCAL\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("proxy.opentracing.enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("proxy.hint.enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("query.with.cipher.column")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sql.show")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("allow.range.query.with.inline.sharding")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("false")]),s._v("\n")])])]),a("ul",[a("li",[a("strong",[s._v("vim config-master_slave.yaml")])])]),s._v(" "),a("blockquote",[a("p",[s._v("读写分离的配置")])]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("schemaName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" sharding_db\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dataSources")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主库地址")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("master_ds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//10.10.10.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3306/ts_kscd_dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("useUnicode=true"),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&characterEncoding=utf8&useSSL=false&serverTimezone=GMT%2B8")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kscd\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mima2018@'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从库地址")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("slave_ds_0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//10.10.10.2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3306/ts_kscd_dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("useUnicode=true"),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&characterEncoding=utf8&useSSL=false&serverTimezone=GMT%2B8")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mima18'")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("connectionTimeoutMilliseconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("idleTimeoutMilliseconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxLifetimeMilliseconds")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1800000")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maxPoolSize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 读写分离配置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("masterSlaveRule")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ms_ds\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("masterDataSourceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master_ds\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("slaveDataSourceNames")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" slave_ds_0\n")])])]),a("h3",{attrs:{id:"下载mysql连接驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载mysql连接驱动"}},[s._v("#")]),s._v(" 下载mysql连接驱动")]),s._v(" "),a("blockquote",[a("p",[s._v("由于没有提供自带的mysql连接驱动，需要我们手动下载放入lib包下，很简单")])]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压后放到lib目录下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://cdn.mysql.com//Downloads/Connector-J/mysql-connector-java-5.1.49.tar.gz\n")])])]),a("h3",{attrs:{id:"使用-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-2"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),a("h4",{attrs:{id:"启动proxy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动proxy"}},[s._v("#")]),s._v(" 启动proxy：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# proxy默认端口是3307,但可能由于端口冲突，所以本次暂拟定8884")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" bin/start.sh "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8884")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -f ~/logs/stdout.log\n")])])]),a("h4",{attrs:{id:"navicat连接proxy代理数据源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#navicat连接proxy代理数据源"}},[s._v("#")]),s._v(" Navicat连接proxy代理数据源")]),s._v(" "),a("blockquote",[a("p",[s._v("如图1，【测试连接】通过后即可；千万不要连，小作者找到了官网的一句话，见图2。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729298930.png",alt:"enter description here"}}),s._v(" "),a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729309009.png",alt:"enter description here"}})]),s._v(" "),a("h4",{attrs:{id:"使用idea连接-查看数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用idea连接-查看数据"}},[s._v("#")]),s._v(" 使用IDEA连接，查看数据")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729317049.png",alt:"enter description here"}})]),s._v(" "),a("h4",{attrs:{id:"后续"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#后续"}},[s._v("#")]),s._v(" 后续")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1602729331396.png",alt:"enter description here"}})]),s._v(" "),a("blockquote",[a("p",[s._v("后续发现，proxy方式还存在很多问题，故而文章先到此为止。")]),s._v(" "),a("blockquote",[a("p",[s._v("1.如果一条数据中2+个字段为NULL时，查询sql会报数组角标越界；")]),s._v(" "),a("p",[s._v("2.中文编码问题；")]),s._v(" "),a("p",[s._v("3.连接池使用是否有效、规范；")])])]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"shardingsphere-jdbc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#shardingsphere-jdbc"}},[s._v("#")]),s._v(" shardingsphere-jdbc")]),s._v(" "),a("blockquote",[a("p",[s._v("由于proxy资料较少，可控性不强。在初步阶段选择采用原始jdbc方式。")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("POM依赖引入")])])]),s._v(" "),a("div",{staticClass:"language-xml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--sharding-jdbc读写分离等配置--\x3e")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("org.apache.shardingsphere"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("sharding-jdbc-spring-boot-starter"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("4.0.0-RC1"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("\x3c!--要把guava隔离，因为swagger也引入了此包造成冲突，随便删除一个低版本就可以；这里是真的坑0=0--\x3e")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("exclusions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("exclusion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.google.guava"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("guava"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("exclusion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("exclusions")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    \n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("dependency")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])])]),a("ul",[a("li",[a("strong",[s._v("配置")])])]),s._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅以读写分离为例；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shardingsphere")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("datasource")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("names")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("slave\n          \n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主库，不要使用_命名，会出现解析失败")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("master")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.zaxxer.hikari.HikariDataSource\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver-class-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.mysql.jdbc.Driver\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jdbc-url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//10.10.10.1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3306/ts_kscd_dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" kscd\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mima2018@'")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从库")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("slave")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.zaxxer.hikari.HikariDataSource\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver-class-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" com.mysql.jdbc.Driver\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jdbc-url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jdbc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//10.10.10.2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("3306/ts_kscd_dev"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("?")]),s._v("serverTimezone=UTC"),a("span",{pre:!0,attrs:{class:"token important"}},[s._v("&useSSL=false")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("username")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n            "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@mima18'")]),s._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置读写分离master、slave")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("masterslave")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ds_ms\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("master-data-source-name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("slave-data-source-names")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" slave\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印sql，方便查找问题")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sql.show")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])])]),a("ul",[a("li",[a("em",[s._v("读写分离已完成，后续加入分片规则")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);