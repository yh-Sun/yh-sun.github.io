(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{733:function(t,s,e){"use strict";e.r(s);var a=e(105),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"æ¦‚è¿°"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#æ¦‚è¿°"}},[t._v("#")]),t._v(" æ¦‚è¿°")]),t._v(" "),e("p",[t._v("Prometheus ä»‹ç»")]),t._v(" "),e("p",[t._v("Prometheusæ˜¯ä¸€å¥—å¼€æºçš„ç›‘æ§&æŠ¥è­¦&æ—¶é—´åºåˆ—æ•°æ®åº“çš„ç»„åˆï¼Œèµ·å§‹æ˜¯ç”±SoundCloudå…¬å¸å¼€å‘çš„ã€‚éšç€å‘å±•ï¼Œè¶Šæ¥è¶Šå¤šå…¬å¸å’Œç»„ç»‡æ¥å—é‡‡ç”¨Prometheusï¼Œç¤¾åŒºä¹Ÿååˆ†æ´»è·ƒï¼Œä»–ä»¬ä¾¿å°†å®ƒç‹¬ç«‹æˆå¼€æºé¡¹ç›®ï¼Œå¹¶ä¸”æœ‰å…¬å¸æ¥è¿ä½œã€‚google SREçš„ä¹¦å†…ä¹Ÿæ›¾æåˆ°è·Ÿä»–ä»¬BorgMonç›‘æ§ç³»ç»Ÿç›¸ä¼¼çš„å®ç°æ˜¯Prometheusã€‚ç°åœ¨æœ€å¸¸è§çš„Kuberneteså®¹å™¨ç®¡ç†ç³»ç»Ÿä¸­ï¼Œé€šå¸¸ä¼šæ­é…Prometheusè¿›è¡Œç›‘æ§ã€‚")]),t._v(" "),e("p"),t._v(" "),e("p",[t._v("Prometheus çš„ä¼˜ç‚¹")]),t._v(" "),e("p",[t._v("1. éå¸¸å°‘çš„å¤–éƒ¨ä¾èµ–ï¼Œå®‰è£…ä½¿ç”¨è¶…ç®€å•")]),t._v(" "),e("p",[t._v("2. å·²ç»æœ‰éå¸¸å¤šçš„ç³»ç»Ÿé›†æˆ ä¾‹å¦‚ï¼šdocker HAProxy Nginx JMXç­‰ç­‰")]),t._v(" "),e("p",[t._v("3. æœåŠ¡è‡ªåŠ¨åŒ–å‘ç°")]),t._v(" "),e("p",[t._v("4. ç›´æ¥é›†æˆåˆ°ä»£ç ")]),t._v(" "),e("p",[t._v("5. è®¾è®¡æ€æƒ³æ˜¯æŒ‰ç…§åˆ†å¸ƒå¼ã€å¾®æœåŠ¡æ¶æ„æ¥å®ç°çš„")]),t._v(" "),e("p"),t._v(" "),e("p",[t._v("Prometheus çš„ç‰¹æ€§")]),t._v(" "),e("p",[t._v("1. è‡ªå®šä¹‰å¤šç»´åº¦çš„æ•°æ®æ¨¡å‹")]),t._v(" "),e("p",[t._v("2. éå¸¸é«˜æ•ˆçš„å­˜å‚¨ å¹³å‡ä¸€ä¸ªé‡‡æ ·æ•°æ®å  ~3.5 byteså·¦å³ï¼Œ320ä¸‡çš„æ—¶é—´åºåˆ—ï¼Œæ¯30ç§’é‡‡æ ·ï¼Œä¿æŒ60å¤©ï¼Œæ¶ˆè€—ç£ç›˜å¤§æ¦‚228Gã€‚")]),t._v(" "),e("p",[t._v("3. å¼ºå¤§çš„æŸ¥è¯¢è¯­å¥")]),t._v(" "),e("p",[t._v("4. è½»æ¾å®ç°æ•°æ®å¯è§†åŒ–")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://gitee.com/TheSunnn/md-pages/raw/master/%E5%B0%8F%E4%B9%A6%E5%8C%A0/1616047231902.png",alt:""}}),t._v(" "),e("img",{attrs:{src:"https://yh-sun.github.io/note-cloud/1618374354163.png",alt:"enter description here"}})]),t._v(" "),e("h2",{attrs:{id:"éƒ¨ç½²"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#éƒ¨ç½²"}},[t._v("#")]),t._v(" éƒ¨ç½²")]),t._v(" "),e("p",[e("strong",[t._v("==å…¨å±€è·¯å¾„ï¼š/home/sun/app_store==")])]),t._v(" "),e("h3",{attrs:{id:"node-exporter"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-exporter"}},[t._v("#")]),t._v(" node_exporter")]),t._v(" "),e("blockquote",[e("p",[t._v("æºç åœ°å€ï¼šhttps://github.com/prometheus/node_exporter")])]),t._v(" "),e("p",[t._v("åœ¨ä¸‹è½½å®‰è£…Prometheusä¹‹å‰æˆ‘ä»¬å…ˆå®‰è£…node_exporteræ’ä»¶ï¼Œç”¨äºæä¾›æœåŠ¡å™¨ç›‘æ§çš„æŒ‡æ ‡(æ¯”å¦‚ï¼šCPUã€å†…å­˜ã€ç£ç›˜ã€ç£ç›˜è¯»å†™é€Ÿç‡ç­‰æŒ‡æ ‡)ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„Prometheus Clientæ’ä»¶ã€‚")]),t._v(" "),e("p",[e("strong",[t._v("1.ä¸‹è½½")])]),t._v(" "),e("div",{staticClass:"language-awk extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("wget -c https://github.com/prometheus/node_exporter/releases/download/v0.18.1/node_exporter-0.18.1.linux-amd64.tar.gz\n")])])]),e("p",[e("strong",[t._v("2.è§£å‹")])]),t._v(" "),e("div",{staticClass:"language-css extra-class"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[t._v("tar -zxvf node_exporter-0.18.1.linux-amd64.tar.gz\nmv node_exporter-0.18.1.linux-amd64 node_exporter\ncd node_exporter\n")])])]),e("p",[e("strong",[t._v("3.åå°è¿è¡Œ")])]),t._v(" "),e("div",{staticClass:"language-lsl extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("nohup ./node_exporter  > ./node_exporter.stdout 2>&1 &\n")])])]),e("p",[e("img",{attrs:{src:"https://gitee.com/TheSunnn/md-pages/raw/master/%E5%B0%8F%E4%B9%A6%E5%8C%A0/1616050255276.png",alt:""}})]),t._v(" "),e("p",[e("strong",[t._v("4.å¯åŠ¨")])]),t._v(" "),e("div",{staticClass:"language-x86asm extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("http://localhost:9100/metrics\n")])])]),e("h3",{attrs:{id:"mysql-exporter"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql-exporter"}},[t._v("#")]),t._v(" mysql_exporter")]),t._v(" "),e("p",[t._v("==æ¨èå›¾æ ‡IDï¼šhttps://grafana.com/dashboards/7362==\n"),e("strong",[t._v("1.ä¸‹è½½")])]),t._v(" "),e("div",{staticClass:"language-awk extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("wget -c https://github.com/prometheus/mysqld_exporter/releases/download/v0.12.1/mysqld_exporter-0.12.1.linux-amd64.tar.gz\n")])])]),e("p",[e("strong",[t._v("2.è§£å‹")])]),t._v(" "),e("div",{staticClass:"language-css extra-class"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[t._v("tar -zxvf mysqld_exporter-0.12.1.linux-amd64.tar.gz\nmv mysqld_exporter-0.12.1.linux-amd64 mysqld_exporter\ncd mysqld_exporter\n")])])]),e("p",[e("strong",[t._v("3.é…ç½®")])]),t._v(" "),e("div",{staticClass:"language-x86asm extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("vi .my.cnf\n\n[client]\nhost=10.1.10.100\nport=3306\nuser=kscd_dev\npassword=Kscd_dev@123\n")])])]),e("p",[e("strong",[t._v("4.åå°è¿è¡Œ")])]),t._v(" "),e("div",{staticClass:"language-lsl extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('nohup ./mysqld_exporter --web.listen-address=":9104" --config.my-cnf=./.my.cnf &\n')])])]),e("p",[e("img",{attrs:{src:"https://gitee.com/TheSunnn/md-pages/raw/master/%E5%B0%8F%E4%B9%A6%E5%8C%A0/1616052397756.png",alt:""}})]),t._v(" "),e("p",[e("strong",[t._v("5.å¯åŠ¨")])]),t._v(" "),e("div",{staticClass:"language-x86asm extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("http://localhost:9104\n")])])]),e("h3",{attrs:{id:"prometheus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prometheus"}},[t._v("#")]),t._v(" prometheus")]),t._v(" "),e("p",[t._v("> ä¸‹è½½åœ°å€ï¼šhttps://prometheus.io/download/\nÂ \n"),e("strong",[t._v("ä¸‹è½½")]),t._v("\nÂ > ä¸‹è½½ç‰ˆæœ¬å·ä¸º2.13.0ï¼Œä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±éœ€è¦ä¸‹è½½å…¶ä»–ç‰ˆæœ¬")]),t._v(" "),e("div",{staticClass:"language-awk extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("wget -c https://github.com/prometheus/prometheus/releases/download/v2.13.0/prometheus-2.13.0.linux-amd64.tar.gz\n")])])]),e("p",[e("strong",[t._v("è§£å‹")])]),t._v(" "),e("div",{staticClass:"language-css extra-class"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[t._v("tar -zxvf prometheus-2.13.0.linux-amd64.tar.gz\nmv prometheus-2.13.0.linux-amd64 prometheus\ncd prometheus\n")])])]),e("p",[e("strong",[t._v("é…ç½®")])]),t._v(" "),e("div",{staticClass:"language-css extra-class"},[e("pre",{pre:!0,attrs:{class:"language-css"}},[e("code",[t._v("vi prometheus.yml\n\n"),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("scrape_configs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  - "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("job_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prometheus'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("static_configs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      - "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("targets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ["),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9090'")]),t._v("]\n\n  - "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("job_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node_exporter'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("static_configs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      - "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("targets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ["),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9100'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10.1.10.99:9100'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'10.1.10.100:9100'")]),t._v("]\n\n  - "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("job_name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mysql'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("static_configs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      - "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v("targets")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ["),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9104'")]),t._v("]\n")])])]),e("p",[e("strong",[t._v("åå°è¿è¡Œ")])]),t._v(" "),e("div",{staticClass:"language-jboss-cli extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("nohup ./prometheus --config.file=prometheus.yml &\n")])])]),e("p",[e("strong",[t._v("å¯åŠ¨")])]),t._v(" "),e("div",{staticClass:"language-x86asm extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("http://localhost:9090\n")])])]),e("p",[t._v("insert metric at cursoré‡Œé¢æ˜¯prometheusç›‘æ§çš„æŒ‡æ ‡\nStatus -> Targetsæ˜¯ç›‘æ§çš„ç›®æ ‡èŠ‚ç‚¹\n"),e("img",{attrs:{src:"https://gitee.com/TheSunnn/md-pages/raw/master/%E5%B0%8F%E4%B9%A6%E5%8C%A0/1616054356264.png",alt:""}})]),t._v(" "),e("p"),t._v(" "),e("h3",{attrs:{id:"prometheusæŠ¥-warning-error-fetching-server-time-detected-1518-seconds-time-difference-between-your-browser-and-the-server"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prometheusæŠ¥-warning-error-fetching-server-time-detected-1518-seconds-time-difference-between-your-browser-and-the-server"}},[t._v("#")]),t._v(" PrometheusæŠ¥ Warning: Error fetching server time: Detected 1518 seconds time difference between your browser and the server.")]),t._v(" "),e("div",{staticClass:"language-stylus extra-class"},[e("pre",{pre:!0,attrs:{class:"language-stylus"}},[e("code",[t._v("åˆ°è£…prometheusçš„æœºå™¨ä¸Šï¼ŒåŒæ­¥ä¸€ä¸‹æ—¶é’Ÿï¼š\n\n"),e("span",{pre:!0,attrs:{class:"token property-declaration"}},[e("span",{pre:!0,attrs:{class:"token property"}},[t._v("ntpdate")]),t._v(" time3.aliyun.com")]),t._v("\n")])])]),e("h2",{attrs:{id:"ç¬¬äºŒæ¬¡å®‰è£…-æˆåŠŸ"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ç¬¬äºŒæ¬¡å®‰è£…-æˆåŠŸ"}},[t._v("#")]),t._v(" ç¬¬äºŒæ¬¡å®‰è£…ï¼ŒæˆåŠŸ")]),t._v(" "),e("p",[t._v("==D:\\AppStore\\Prometheus==")]),t._v(" "),e("h3",{attrs:{id:"grafana"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#grafana"}},[t._v("#")]),t._v(" grafana")]),t._v(" "),e("ol",[e("li",[t._v("wget https://dl.grafana.com/oss/release/grafana-7.5.4-1.x86_64.rpm")]),t._v(" "),e("li",[t._v("sudo yum install grafana-7.5.4-1.x86_64.rpm")]),t._v(" "),e("li",[t._v("find / -name '"),e("em",[t._v("grafana")]),t._v("'")]),t._v(" "),e("li",[t._v("cd /usr/share/grafana/")]),t._v(" "),e("li",[t._v("find / -name '"),e("em",[t._v("grafana-server")]),t._v("'")]),t._v(" "),e("li",[t._v("grafana-server web")])]),t._v(" "),e("blockquote",[e("p",[t._v("3 4 5 æ²¡å•¥ç”¨ï¼Œyumè£…å®Œä¸ç”¨é…ç½®ç¯å¢ƒå˜é‡ï¼Œç›´æ¥æ‰§è¡Œgrafana-server web &åå°å¯åŠ¨å°±å¯ä»¥äº†")])]),t._v(" "),e("div",{staticClass:"language-lsl extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ä¿®æ”¹é»˜è®¤3000ç«¯å£ä¸º9091\nvi defaults.ini \n")])])]),e("p",[t._v("ä¼˜ç§€çš„å›¾æ ‡IDï¼š11074ï¼ˆnode è‹±æ–‡ï¼‰ã€8919ï¼ˆnode ä¸­æ–‡ï¼‰")]),t._v(" "),e("h3",{attrs:{id:"prometheus-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prometheus-2"}},[t._v("#")]),t._v(" prometheus")]),t._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" prometheus.yml\n\n\nscrape_configs:\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.")]),t._v("\n  - job_name: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'prometheus'")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# metrics_path defaults to '/metrics'")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# scheme defaults to 'http'.")]),t._v("\n\n    static_configs:\n    - targets: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9090'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n  - job_name: "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'linux'")]),t._v("\n    static_configs:\n    - targets: "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'localhost:9100'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      labels:\n        instance: node1\n")])])]),e("p",[e("strong",[t._v("ğŸ˜‰åé¢çš„node_exporterä¹Ÿéƒ½æ²¡å•¥ç‰¹æ®Šçš„ï¼Œå®‰è£…æ–¹å¼ä¸ç¬¬ä¸€æ¬¡ç›¸åŒã€‚ä½†å°±æ˜¯æˆåŠŸäº†ï¼Œå˜¿å˜¿å˜¿ï¼")])])])}),[],!1,null,null,null);s.default=r.exports}}]);